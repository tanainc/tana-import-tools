# Repository Guidelines

## Project Structure & Module Organization

- `src/`: TypeScript source.
  - `converters/*`: Converter implementations with `index.ts`, utils, and `tests/`.
  - `types/`: Tana Intermediate Format types (`types.ts`).
  - `utils/`, `testUtils/`: Shared helpers and test utilities.
  - `runner.ts`: CLI entry used by convert scripts.
- `dist/`: Compiled ESM output (generated by build).
- `samples/`: Example datasets for local testing.

## Build, Test, and Development Commands

- `npm install`: Install dependencies (Node 22+).
- `npm run build`: Compile TS to `dist/` (excludes tests).
- `npm test`: Run unit tests with Vitest.
- `npm run lint`: Lint with ESLint (TS rules enabled).
- `npm run format`: Format with Prettier.
- Run converters locally after build:
  - `npm run convert:roam path/to/export.json`
  - `npm run convert:workflowy path/to/export.opml`
  - `npm run convert:logseq path/to/export.json`

## Coding Style & Naming Conventions

- Prettier: 2-space indent, single quotes, trailing commas, width 120, arrow parens always.
- TypeScript: strict mode, ESM modules, Node typing.
- File naming: `.ts`; tests as `*.test.ts` (often under `converters/*/tests`).
- Prefer small, pure functions; named exports from `index.ts`.

## Testing Guidelines

- Framework: Vitest. Place tests next to converters or under `tests/` folders.
- Use helpers in `src/testUtils/testUtils.ts` (e.g., `importFileAndGetHelpers`).
- Add tests for new converters and for bug fixes (see `CONTRIBUTING.md`).
- Run `npm run test` locally; keep tests independent of network and filesystem side effects.

## Agent Run Notes

- Node version: ensure Node 22+ (e.g., `nvm use 22`).
- Sandboxed environments: run Vitest with threads to avoid worker kill errors: `npm test -- --pool=threads`.

## Commit & Pull Request Guidelines

- Commits: short, imperative, scoped messages (e.g., `logseq: handle NOW/DOING todos`).
- PRs: include clear description, sample input/output, linked issues, and tests. Update README if user-facing behavior changes.
- Keep diffs focused; follow existing module layout and naming.

## Security & Configuration Tips

- Do not commit private datasets; use `samples/` or redact sensitive data.
- Environment: Node 22+, npm, ESM-only.
- Generated files in `dist/` are built artifactsâ€”avoid editing by hand.
